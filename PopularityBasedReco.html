<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>85ba1cb7e43f407b92199319db20a103</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="objective-to-build-a-song-recommender"
class="cell markdown">
<h1>Objective: To Build a song Recommender</h1>
</section>
<section id="dataset-used-million-songs-dataset" class="cell markdown">
<h1>Dataset used: Million Songs Dataset</h1>
<p>Source: <a href="http://labrosa.ee.columbia.edu/millionsong/"
class="uri">http://labrosa.ee.columbia.edu/millionsong/</a></p>
</section>
<section id="q1-load-required-libraries-and-music-data"
class="cell markdown">
<h1>Q1. Load Required Libraries and music data</h1>
</section>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.externals <span class="im">import</span> joblib</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.core.interactiveshell <span class="im">import</span> InteractiveShell</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>InteractiveShell.ast_node_interactivity <span class="op">=</span> <span class="st">&quot;all&quot;</span></span></code></pre></div>
</div>
<section id="load-music-data" class="cell markdown">
<h1>Load Music data</h1>
</section>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Read userid-songid-listen_count triplets</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#This step might take time to download data from external sources</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>triplets_file <span class="op">=</span> <span class="st">&#39;https://static.turi.com/datasets/millionsong/10000.txt&#39;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>songs_metadata_file <span class="op">=</span> <span class="st">&#39;https://static.turi.com/datasets/millionsong/song_data.csv&#39;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>song_df_1 <span class="op">=</span> pandas.read_table(triplets_file,header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>song_df_1.columns <span class="op">=</span> [<span class="st">&#39;user_id&#39;</span>, <span class="st">&#39;song_id&#39;</span>, <span class="st">&#39;listen_count&#39;</span>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Read song  metadata</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>song_df_2 <span class="op">=</span>  pandas.read_csv(songs_metadata_file)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Merge the two dataframes above to create input dataframe for recommender systems</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>song_df <span class="op">=</span> pandas.merge(song_df_1, song_df_2.drop_duplicates([<span class="st">&#39;song_id&#39;</span>]), on<span class="op">=</span><span class="st">&quot;song_id&quot;</span>, how<span class="op">=</span><span class="st">&quot;left&quot;</span>) </span></code></pre></div>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(song_df_1.head())</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(song_df_1)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                                    user_id             song_id  listen_count
0  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SOAKIMP12A8C130995             1
1  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SOBBMDR12A8C13253B             2
2  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SOBXHDL12A81C204C0             1
3  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SOBYHAJ12A6701BF1D             1
4  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SODACBL12A8C13C273             1
</code></pre>
</div>
<div class="output execute_result" data-execution_count="12">
<pre><code>2000000</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>song_df_2.head()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(song_df_2)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(song_df_2.head(<span class="dv">5</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(song_df)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(song_df.head(<span class="dv">5</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>song_id</th>
      <th>title</th>
      <th>release</th>
      <th>artist_name</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SOQMMHC12AB0180CB8</td>
      <td>Silent Night</td>
      <td>Monster Ballads X-Mas</td>
      <td>Faster Pussy cat</td>
      <td>2003</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SOVFVAK12A8C1350D9</td>
      <td>Tanssi vaan</td>
      <td>Karkuteillä</td>
      <td>Karkkiautomaatti</td>
      <td>1995</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SOGTUKN12AB017F4F1</td>
      <td>No One Could Ever</td>
      <td>Butter</td>
      <td>Hudson Mohawke</td>
      <td>2006</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SOBNYVR12A8C13558C</td>
      <td>Si Vos Querés</td>
      <td>De Culo</td>
      <td>Yerba Brava</td>
      <td>2003</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SOHSBXH12A8C13B0DF</td>
      <td>Tangle Of Aspens</td>
      <td>Rene Ablaze Presents Winter Sessions</td>
      <td>Der Mystic</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output execute_result" data-execution_count="13">
<pre><code>1000000</code></pre>
</div>
<div class="output stream stdout">
<pre><code>              song_id              title  \
0  SOQMMHC12AB0180CB8       Silent Night   
1  SOVFVAK12A8C1350D9        Tanssi vaan   
2  SOGTUKN12AB017F4F1  No One Could Ever   
3  SOBNYVR12A8C13558C      Si Vos Querés   
4  SOHSBXH12A8C13B0DF   Tangle Of Aspens   

                                release       artist_name  year  
0                 Monster Ballads X-Mas  Faster Pussy cat  2003  
1                           Karkuteillä  Karkkiautomaatti  1995  
2                                Butter    Hudson Mohawke  2006  
3                               De Culo       Yerba Brava  2003  
4  Rene Ablaze Presents Winter Sessions        Der Mystic     0  
</code></pre>
</div>
<div class="output execute_result" data-execution_count="13">
<pre><code>2000000</code></pre>
</div>
<div class="output stream stdout">
<pre><code>                                    user_id             song_id  listen_count  \
0  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SOAKIMP12A8C130995             1   
1  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SOBBMDR12A8C13253B             2   
2  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SOBXHDL12A81C204C0             1   
3  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SOBYHAJ12A6701BF1D             1   
4  b80344d063b5ccb3212f76538f3d9e43d87dca9e  SODACBL12A8C13C273             1   

             title                        release    artist_name  year  
0         The Cove             Thicker Than Water   Jack Johnson     0  
1  Entre Dos Aguas            Flamenco Para Niños  Paco De Lucia  1976  
2         Stronger                     Graduation     Kanye West  2007  
3   Constellations              In Between Dreams   Jack Johnson  2005  
4     Learn To Fly  There Is Nothing Left To Lose   Foo Fighters  1999  
</code></pre>
</div>
</div>
<section id="q2-explore-data" class="cell markdown">
<h1>Q2. Explore data</h1>
<p>Music data shows how many times a user listened to a song, as well as
the details of the song.</p>
</section>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>song_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>song_id</th>
      <th>listen_count</th>
      <th>title</th>
      <th>release</th>
      <th>artist_name</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b80344d063b5ccb3212f76538f3d9e43d87dca9e</td>
      <td>SOAKIMP12A8C130995</td>
      <td>1</td>
      <td>The Cove</td>
      <td>Thicker Than Water</td>
      <td>Jack Johnson</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b80344d063b5ccb3212f76538f3d9e43d87dca9e</td>
      <td>SOBBMDR12A8C13253B</td>
      <td>2</td>
      <td>Entre Dos Aguas</td>
      <td>Flamenco Para Niños</td>
      <td>Paco De Lucia</td>
      <td>1976</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b80344d063b5ccb3212f76538f3d9e43d87dca9e</td>
      <td>SOBXHDL12A81C204C0</td>
      <td>1</td>
      <td>Stronger</td>
      <td>Graduation</td>
      <td>Kanye West</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b80344d063b5ccb3212f76538f3d9e43d87dca9e</td>
      <td>SOBYHAJ12A6701BF1D</td>
      <td>1</td>
      <td>Constellations</td>
      <td>In Between Dreams</td>
      <td>Jack Johnson</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>4</th>
      <td>b80344d063b5ccb3212f76538f3d9e43d87dca9e</td>
      <td>SODACBL12A8C13C273</td>
      <td>1</td>
      <td>Learn To Fly</td>
      <td>There Is Nothing Left To Lose</td>
      <td>Foo Fighters</td>
      <td>1999</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="length-of-the-dataset" class="cell markdown">
<h1>Length of the dataset</h1>
</section>
<div class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(song_df)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>song_df <span class="op">=</span> song_df.head(<span class="dv">10000</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(song_df)</span></code></pre></div>
<div class="output execute_result" data-execution_count="15">
<pre><code>2000000</code></pre>
</div>
<div class="output execute_result" data-execution_count="15">
<pre><code>10000</code></pre>
</div>
</div>
<section id="q3-create-a-subset-of-the-dataset" class="cell markdown">
<h1>Q3. Create a subset of the dataset</h1>
<p>a. Show the most popular songs in the dataset</p>
<p>b. Count number of unique users in the dataset</p>
<p>c. Count the number of unique songs in the dataset</p>
</section>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>song_df <span class="op">=</span> song_df.head(<span class="dv">10000</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Merge song title and artist_name columns to make a merged column</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>song_df[<span class="st">&#39;song&#39;</span>] <span class="op">=</span> song_df[<span class="st">&#39;title&#39;</span>].<span class="bu">map</span>(<span class="bu">str</span>) <span class="op">+</span> <span class="st">&quot; - &quot;</span> <span class="op">+</span> song_df[<span class="st">&#39;artist_name&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>song_grouped <span class="op">=</span> song_df.groupby([<span class="st">&#39;song&#39;</span>]).agg({<span class="st">&#39;listen_count&#39;</span>: <span class="st">&#39;count&#39;</span>}).reset_index()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>grouped_sum <span class="op">=</span> song_grouped[<span class="st">&#39;listen_count&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>song_grouped[<span class="st">&#39;percentage&#39;</span>]  <span class="op">=</span> song_grouped[<span class="st">&#39;listen_count&#39;</span>].div(grouped_sum)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>song_grouped.sort_values([<span class="st">&#39;listen_count&#39;</span>, <span class="st">&#39;song&#39;</span>], ascending <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>])</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>song</th>
      <th>listen_count</th>
      <th>percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3660</th>
      <td>Sehr kosmisch - Harmonia</td>
      <td>45</td>
      <td>0.45</td>
    </tr>
    <tr>
      <th>4678</th>
      <td>Undo - Björk</td>
      <td>32</td>
      <td>0.32</td>
    </tr>
    <tr>
      <th>5105</th>
      <td>You're The One - Dwight Yoakam</td>
      <td>32</td>
      <td>0.32</td>
    </tr>
    <tr>
      <th>1071</th>
      <td>Dog Days Are Over (Radio Edit) - Florence + Th...</td>
      <td>28</td>
      <td>0.28</td>
    </tr>
    <tr>
      <th>3655</th>
      <td>Secrets - OneRepublic</td>
      <td>28</td>
      <td>0.28</td>
    </tr>
    <tr>
      <th>4378</th>
      <td>The Scientist - Coldplay</td>
      <td>27</td>
      <td>0.27</td>
    </tr>
    <tr>
      <th>4712</th>
      <td>Use Somebody - Kings Of Leon</td>
      <td>27</td>
      <td>0.27</td>
    </tr>
    <tr>
      <th>3476</th>
      <td>Revelry - Kings Of Leon</td>
      <td>26</td>
      <td>0.26</td>
    </tr>
    <tr>
      <th>1387</th>
      <td>Fireflies - Charttraxx Karaoke</td>
      <td>24</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>1862</th>
      <td>Horn Concerto No. 4 in E flat K495: II. Romanc...</td>
      <td>23</td>
      <td>0.23</td>
    </tr>
    <tr>
      <th>1805</th>
      <td>Hey_ Soul Sister - Train</td>
      <td>22</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>5032</th>
      <td>Yellow - Coldplay</td>
      <td>22</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>808</th>
      <td>Clocks - Coldplay</td>
      <td>21</td>
      <td>0.21</td>
    </tr>
    <tr>
      <th>2620</th>
      <td>Lucky (Album Version) - Jason Mraz &amp; Colbie Ca...</td>
      <td>20</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>2299</th>
      <td>Just Dance - Lady GaGa / Colby O'Donis</td>
      <td>19</td>
      <td>0.19</td>
    </tr>
    <tr>
      <th>456</th>
      <td>Billionaire [feat. Bruno Mars]  (Explicit Albu...</td>
      <td>18</td>
      <td>0.18</td>
    </tr>
    <tr>
      <th>2689</th>
      <td>Marry Me - Train</td>
      <td>18</td>
      <td>0.18</td>
    </tr>
    <tr>
      <th>3064</th>
      <td>OMG - Usher featuring will.i.am</td>
      <td>18</td>
      <td>0.18</td>
    </tr>
    <tr>
      <th>4543</th>
      <td>Tive Sim - Cartola</td>
      <td>18</td>
      <td>0.18</td>
    </tr>
    <tr>
      <th>142</th>
      <td>Alejandro - Lady GaGa</td>
      <td>17</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th>726</th>
      <td>Catch You Baby (Steve Pitron &amp; Max Sanna Radio...</td>
      <td>17</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th>1410</th>
      <td>Float On - Modest Mouse</td>
      <td>17</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th>3868</th>
      <td>Somebody To Love - Justin Bieber</td>
      <td>17</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th>631</th>
      <td>Bulletproof - La Roux</td>
      <td>16</td>
      <td>0.16</td>
    </tr>
    <tr>
      <th>1143</th>
      <td>Drop The World - Lil Wayne / Eminem</td>
      <td>16</td>
      <td>0.16</td>
    </tr>
    <tr>
      <th>3038</th>
      <td>Nothin' On You [feat. Bruno Mars] (Album Versi...</td>
      <td>16</td>
      <td>0.16</td>
    </tr>
    <tr>
      <th>4465</th>
      <td>They Might Follow You - Tiny Vipers</td>
      <td>16</td>
      <td>0.16</td>
    </tr>
    <tr>
      <th>870</th>
      <td>Cosmic Love - Florence + The Machine</td>
      <td>15</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>899</th>
      <td>Creep (Explicit) - Radiohead</td>
      <td>15</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>1680</th>
      <td>Halo - Beyoncé</td>
      <td>15</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5094</th>
      <td>You Yourself are Too Serious - The Mercury Pro...</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5098</th>
      <td>You'll Never Know (My Love) (Bovellian 07 Mix)...</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5100</th>
      <td>You're A Wolf (Album) - Sea Wolf</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5102</th>
      <td>You're Gonna Miss Me When I'm Gone - Brooks &amp; ...</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5103</th>
      <td>You're Not Alone - ATB</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5104</th>
      <td>You're Not Alone - Olive</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5108</th>
      <td>You've Passed - Neutral Milk Hotel</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5109</th>
      <td>Young - Hollywood Undead</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5111</th>
      <td>Younger Than Springtime - William Tabbert</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5112</th>
      <td>Your Arms Feel Like home - 3 Doors Down</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5113</th>
      <td>Your Every Idol - Telefon Tel Aviv</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5114</th>
      <td>Your Ex-Lover Is Dead (Album Version) - Stars</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5115</th>
      <td>Your Guardian Angel - The Red Jumpsuit Apparatus</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5117</th>
      <td>Your House - Jimmy Eat World</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5118</th>
      <td>Your Love - The Outfield</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5121</th>
      <td>Your Mouth - Telefon Tel Aviv</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5123</th>
      <td>Your Song (Alternate Take 10) - Cilla Black</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5126</th>
      <td>Your Visits Are Getting Shorter - Bloc Party</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5127</th>
      <td>Your Woman - White Town</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5130</th>
      <td>Ze Rook Naar Rozen - Rob De Nijs</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5131</th>
      <td>Zebra - Beach House</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5132</th>
      <td>Zebra - Man Man</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5133</th>
      <td>Zero - The Pain Machinery</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5135</th>
      <td>Zopf: Pigtail - Penguin Café Orchestra</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5137</th>
      <td>aNYway - Armand Van Helden &amp; A-TRAK Present Du...</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5139</th>
      <td>high fives - Four Tet</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5140</th>
      <td>in white rooms - Booka Shade</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5143</th>
      <td>paranoid android - Christopher O'Riley</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5149</th>
      <td>¿Lo Ves? [Piano Y Voz] - Alejandro Sanz</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5150</th>
      <td>Época - Gotan Project</td>
      <td>1</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>
<p>5151 rows × 3 columns</p>
</div>
</div>
</div>
<section id="count-number-of-unique-users-in-the-dataset"
class="cell markdown">
<h1>Count number of unique users in the dataset</h1>
</section>
<div class="cell code">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> song_df[<span class="st">&#39;user_id&#39;</span>].unique()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(users)</span></code></pre></div>
</div>
<section id="count-the-number-of-unique-songs-in-the-dataset"
class="cell markdown">
<h1>Count the number of unique songs in the dataset</h1>
</section>
<div class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">###Fill in the code here</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> song_df[<span class="st">&#39;song&#39;</span>].unique()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(songs)</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">
<pre><code>5151</code></pre>
</div>
</div>
<section id="q4-create-a-song-recommender" class="cell markdown">
<h1>Q4. Create a song recommender</h1>
</section>
<div class="cell code" data-execution_count="20" data-scrolled="true">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>train_data, test_data <span class="op">=</span> train_test_split(song_df, test_size <span class="op">=</span> <span class="fl">0.20</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data.head(<span class="dv">5</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                                       user_id             song_id  \
7389  94d5bdc37683950e90c56c9b32721edb5d347600  SOXNZOW12AB017F756   
9275  1012ecfd277b96487ed8357d02fa8326b13696a5  SOXHYVQ12AB0187949   
2995  15415fa2745b344bce958967c346f2a89f792f63  SOOSZAZ12A6D4FADF8   
5316  ffadf9297a99945c0513cd87939d91d8b602936b  SOWDJEJ12A8C1339FE   
356   5a905f000fc1ff3df7ca807d57edb608863db05d  SOAMPRJ12A8AE45F38   

      listen_count                 title  \
7389             2      Half Of My Heart   
9275             1  The Beautiful People   
2995             1     Sanctify Yourself   
5316             4     Heart Cooks Brain   
356             20                 Rorol   

                                                release      artist_name  \
7389                                     Battle Studies       John Mayer   
9275             Antichrist Superstar (Ecopac Explicit)   Marilyn Manson   
2995                             Glittering Prize 81/92     Simple Minds   
5316  Everything Is Nice: The Matador Records 10th A...     Modest Mouse   
356                               Identification Parade  Octopus Project   

      year                                   song  
7389     0          Half Of My Heart - John Mayer  
9275     0  The Beautiful People - Marilyn Manson  
2995  1985       Sanctify Yourself - Simple Minds  
5316  1997       Heart Cooks Brain - Modest Mouse  
356   2002                Rorol - Octopus Project  
</code></pre>
</div>
</div>
<section id="q5-build-popularity-recommender-model-non-personalised"
class="cell markdown">
<h1>Q5. Build Popularity Recommender model. (Non-personalised)</h1>
<p>a. Count of user_id for each unique song as recommendation score</p>
<p>b. Sort the songs on recommendation score</p>
<p>c. Get the top 5 recommendations</p>
</section>
<div class="cell code" data-execution_count="29">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Count of user_id for each unique song as recommendation score </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>train_data_grouped <span class="op">=</span> train_data.groupby(<span class="st">&#39;song_id&#39;</span>).agg({<span class="st">&#39;user_id&#39;</span>: <span class="st">&#39;count&#39;</span>}).reset_index()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>train_data_grouped.rename(columns <span class="op">=</span> {<span class="st">&#39;user_id&#39;</span>: <span class="st">&#39;score&#39;</span>},inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>train_data_grouped.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>song_id</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SOAAFAC12A67ADF7EB</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SOAATLI12A8C13E319</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SOAAUKC12AB017F868</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SOAAVUV12AB0186646</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SOAAWEE12A6D4FBEC8</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="30">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sort the songs on recommendation score </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>train_data_sort <span class="op">=</span> train_data_grouped.sort_values([<span class="st">&#39;score&#39;</span>, <span class="st">&#39;song_id&#39;</span>], ascending <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>]) </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Generate a recommendation rank based upon score </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>train_data_sort[<span class="st">&#39;Rank&#39;</span>] <span class="op">=</span> train_data_sort[<span class="st">&#39;score&#39;</span>].rank(ascending<span class="op">=</span><span class="dv">0</span>, method<span class="op">=</span><span class="st">&#39;first&#39;</span>) </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the top 5 recommendations </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>popularity_recommendations <span class="op">=</span> train_data_sort.head(<span class="dv">5</span>) </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>popularity_recommendations </span></code></pre></div>
<div class="output execute_result" data-execution_count="30">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>song_id</th>
      <th>score</th>
      <th>Rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1006</th>
      <td>SOFRQTD12A81C233C0</td>
      <td>37</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>146</th>
      <td>SOAUWYT12A81C206F1</td>
      <td>27</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>166</th>
      <td>SOAXGDH12A8C13F8A1</td>
      <td>24</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>286</th>
      <td>SOBONKR12A58A7A7E0</td>
      <td>24</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2481</th>
      <td>SONYKOW12AB01849C9</td>
      <td>21</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section
id="q6-use-popularity-based-recommender-model-to-make-predictions-and-find-recommendations-for-random-list-of-users-with-inferences"
class="cell markdown">
<h1>Q6. Use popularity based recommender model to make predictions and
find recommendations for random list of users with inferences</h1>
</section>
<div class="cell code" data-execution_count="31">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use popularity based recommender model to make predictions</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recommend(user_id):     </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    user_recommendations <span class="op">=</span> popularity_recommendations </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Add user_id column for which the recommendations are being generated </span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    user_recommendations[<span class="st">&#39;userID&#39;</span>] <span class="op">=</span> user_id </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Bring user_id column to the front </span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    cols <span class="op">=</span> user_recommendations.columns.tolist() </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    cols <span class="op">=</span> cols[<span class="op">-</span><span class="dv">1</span>:] <span class="op">+</span> cols[:<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    user_recommendations <span class="op">=</span> user_recommendations[cols] </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> user_recommendations </span></code></pre></div>
</div>
<div class="cell code" data-execution_count="32">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>find_recom <span class="op">=</span> [<span class="dv">15</span>,<span class="dv">121</span>,<span class="dv">53</span>]   <span class="co"># This list is user choice.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> find_recom:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Here is the recommendation for the userId: </span><span class="sc">%d</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">%</span>(i))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(recommend(i))    </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) </span></code></pre></div>
<div class="output stream stdout">
<pre><code>Here is the recommendation for the userId: 15

      userID             song_id  score  Rank
1006      15  SOFRQTD12A81C233C0     37   1.0
146       15  SOAUWYT12A81C206F1     27   2.0
166       15  SOAXGDH12A8C13F8A1     24   3.0
286       15  SOBONKR12A58A7A7E0     24   4.0
2481      15  SONYKOW12AB01849C9     21   5.0


Here is the recommendation for the userId: 121

</code></pre>
</div>
<div class="output stream stderr">
<pre><code>C:\ProgramData\Anaconda3\lib\site-packages\ipykernel_launcher.py:6: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>      userID             song_id  score  Rank
1006     121  SOFRQTD12A81C233C0     37   1.0
146      121  SOAUWYT12A81C206F1     27   2.0
166      121  SOAXGDH12A8C13F8A1     24   3.0
286      121  SOBONKR12A58A7A7E0     24   4.0
2481     121  SONYKOW12AB01849C9     21   5.0


Here is the recommendation for the userId: 53

      userID             song_id  score  Rank
1006      53  SOFRQTD12A81C233C0     37   1.0
146       53  SOAUWYT12A81C206F1     27   2.0
166       53  SOAXGDH12A8C13F8A1     24   3.0
286       53  SOBONKR12A58A7A7E0     24   4.0
2481      53  SONYKOW12AB01849C9     21   5.0


</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Since this is a popularity-based recommender model, recommendations
remain the same for all users</p>
<p>We predict the products based on the popularity. It is not
personalized to particular user</p>
</div>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"9686c0c3da343ab2","version":"2025.7.0","r":1,"token":"0357a45f23a943f08700f7f9af191ee6","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}}}' crossorigin="anonymous"></script>
</body>
</html>
